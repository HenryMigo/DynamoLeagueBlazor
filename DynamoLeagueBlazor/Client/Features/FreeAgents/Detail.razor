@page "/freeagents/{playerId:int}"

@if(_result is null)
{
    <MudCard>
        <MudSkeleton SkeletonType="SkeletonType.Rectangle" Height="100%" Width="100%" />
        <MudCardContent>
            <MudSkeleton Width="30%" />
            <MudSkeleton Width="80%" />
            <MudSkeleton Width="100%" />
        </MudCardContent>
        <MudCardActions>
            <MudSkeleton Width="64px" Height="40px" Class="ml-2" />
            <MudSkeleton Width="105px" Height="40px" Class="ml-3" />
        </MudCardActions>
    </MudCard>
}
else
{
    <Title>
        @_title
    </Title>

    <MudGrid>
        <MudItem md=6 xs=12>

        </MudItem>
        <MudItem md=6 xs=12>
            <MudText Typo=Typo.h4>Submit A New Bid</MudText>
            <EditForm Model=_form OnValidSubmit=OnValidSubmitAsync>
                <FluentValidationValidator />
	            <MudItem xs="12" sm="6" md="4">
		            <MudNumericField @bind-Value="_form.Amount" Label="Bid Amount" Variant="Variant.Text" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.AttachMoney" HideSpinButtons="true" />
	            </MudItem>
                <MudButton Color="Color.Success" Variant=Variant.Outlined StartIcon=@Icons.Outlined.Check OnClick="OnValidSubmitAsync" Disabled="@_processingForm">
                    @if (_processingForm)
                    {
                        <MudProgressCircular Class="ms-n1" Size="Size.Small" Indeterminate="true"/>
                        <MudText Class="ms-2">Saving...</MudText>
                    }
                    else
                    {
                        <MudText>Save</MudText>
                    }
                </MudButton>
            </EditForm>
        </MudItem>
        <MudItem xs=12>
            <MudTimeline>
                @{
                    var firstBid = _result.Bids.FirstOrDefault();
                }
                if(firstBid is not null)
                {
                    <MudTimelineItem Icon=@Icons.Outlined.Money Size=Size.Large Color=Color.Success>
                        <MudAlert Severity="Severity.Success">
                            @firstBid!.Team is winning with a bid of <b>@firstBid.Amount</b> on @(firstBid.Date)!
                        </MudAlert>
                    </MudTimelineItem>
                }
                @foreach(var bid in _result.Bids.Skip(1))
                {
                    <MudTimelineItem Icon=@Icons.Outlined.Money>
                        <ItemContent>
                            @bid!.Team bid @bid.Amount on @(bid.Date).
                        </ItemContent>
                    </MudTimelineItem>
                }
            </MudTimeline>
        </MudItem>
    </MudGrid>
}
